<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>PRML 第1章 演習 1.31-1.41</title>
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "left",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">PRML 第1章 演習 1.31-1.41</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">PRML 第1章 演習 1.31-1.41</a>
<ul>
<li><a href="#sec-1-1"><span class="todo TODO">TODO</span> 1.31 [www] H[x,y] ≦ H[x] + H[y] の証明</a></li>
<li><a href="#sec-1-2"><span class="todo TODO">TODO</span> 1.32</a></li>
<li><a href="#sec-1-3"><span class="todo TODO">TODO</span> 1.33</a></li>
<li><a href="#sec-1-4"><span class="done DONE">DONE</span> 1.34 [www] 微分エントロピーを最大にする分布がガウス分布であることの証明</a></li>
<li><a href="#sec-1-5"><span class="todo TODO">TODO</span> 1.35 [www]</a></li>
<li><a href="#sec-1-6"><span class="done DONE">DONE</span> 1.36 凸⇔2階微分が正</a></li>
<li><a href="#sec-1-7"><span class="done DONE">DONE</span> 1.37 H[x,y] = H[y|x] + H[x] (1.112) の証明</a></li>
<li><a href="#sec-1-8"><span class="todo TODO">TODO</span> 1.38 [www] イェンセンの不等式</a></li>
<li><a href="#sec-1-9"><span class="todo TODO">TODO</span> 1.39</a></li>
<li><a href="#sec-1-10"><span class="todo TODO">TODO</span> 1.40</a></li>
<li><a href="#sec-1-11"><span class="done DONE">DONE</span> 1.41 [www] 相互情報量\(I[x,y] = H[x] - H[x|y]\)の証明</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">PRML 第1章 演習 1.31-1.41</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="todo TODO">TODO</span> 1.31 [www] H[x,y] ≦ H[x] + H[y] の証明</h3>
<div class="outline-text-3" id="text-1-1">
<p>
同時確率分布の微分エントロピーの定義<br  />
    H[x,y] = - &int;&int; p(x,y) ln p(x,y) dydx<br  />
</p>

<p>
p(x,y) = p(x)p(y) ならば<br  />
    H[x,y] = - &int;&int; p(x,y) ln p(x)p(y) dydx<br  />
           = - &int;&int; p(x,y) {ln p(x) + ln p(y)} dydx<br  />
           = - &int;&int; p(x,y) ln p(x) dydx - &int;&int; p(x,y) ln p(y) dydx<br  />
           = H[x] + H[y]<br  />
</p>

<p>
    H[x,y] =  - &int;&int; p(x,y) ln p(x,y) dydx<br  />
イェンセンの不等式より<br  />
    H[x,y] ≦ - ln &int;&int; p(x,y) p(x,y) dydx<br  />
&int;&int; p(x,y) dydx = 1 という制約のもとで<br  />
上の式の左辺を最大にする p(x,y) は p(x)p(y)??????<br  />
</p>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="todo TODO">TODO</span> 1.32</h3>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="todo TODO">TODO</span> 1.33</h3>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="done DONE">DONE</span> 1.34 [www] 微分エントロピーを最大にする分布がガウス分布であることの証明</h3>
<div class="outline-text-3" id="text-1-4">
<p>
付録Dより、\(F[y] = ∫_{x_1}^{x_2} G(y(x),y'(x),x) dx\)の停留点は <br  />
\(\frac{∂G}{∂y} - \frac{d}{dx}\frac{∂G}{∂y'} = 0\)を満たす\(y(x)\)である。 <br  />
(1.108)の上の式をp(x)の汎関数F[p]とする。<br  />
</p>
\begin{align*}
    F[p] = & - ∫_{-∞}^∞ p(x) \ln p(x) dx
             + λ_1 \left( ∫_{-∞}^∞ p(x) dx - 1 \right) \\
           & + λ_2 \left( ∫_{-∞}^∞ x p(x) dx - μ \right)
             + λ_3 \left( ∫_{-∞}^∞ (x - μ)^2 p(x) dx - σ^2 \right)
\end{align*}
<p>
すると<br  />
</p>
\begin{align*}
    G(p(x),p'(x),x) = - p(x) \ln p(x) + λ_1 p(x) + λ_2 x p(x) + λ_3 (x - μ)^2 p(x)
\end{align*}
<p>
停留点は<br  />
</p>
\begin{align*}
    0 = & \frac{∂G}{∂p} G(p(x),p'(x),x) \\
    0 = & \frac{∂G}{∂p} \{ - p(x) \ln p(x) + λ_1 p(x) + λ_2 x p(x) + λ_3 (x - μ)^2 p(x) \} \\
    0 = & - \ln p(x) - 1 + λ_1 + λ_2 x + λ_3 (x - μ)^2 \\
    p(x) = & \exp \{ - 1 + λ_1 + λ_2 x + λ_3 (x - μ)^2 \}    & \text{(1.108)} \\
\end{align*}
<p>
これを少し変形し<br  />
</p>
\begin{align*}
    p(x) = \exp \{ - 1 + λ_1 + λ_2 x \} \exp\{ λ_3 (x - μ)^2 \} \\
\end{align*}
<p>
ガウス分布の式<br  />
</p>
\begin{align*}
    N(x|μ,σ^2) = (2π σ^2)^{-1/2} \exp \{ - \frac{1}{2 σ^2} (x - μ)^2 \}
\end{align*}
<p>
と比較すると、<br  />
</p>
\begin{align*}
    λ_1 = & 1 - \frac{1}{2} \ln (2π σ^2) \\
    λ_2 = & 0 \\
    λ_3 = & - \frac{1}{2 σ^2} \\
\end{align*}
<p>
と置けば両者は一致し、(1.105)-(1.107)を満たす。<br  />
</p>
</div>

<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">WWWの解答</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
(1.108)の上の式をp(x)の汎関数F[p]とする。<br  />
</p>
\begin{align*}
    F[p] = & - ∫_{-∞}^∞ p(x) \ln p(x) dx
             + λ_1 \left( ∫_{-∞}^∞ p(x) dx - 1 \right) \\
           & + λ_2 \left( ∫_{-∞}^∞ x p(x) dx - μ \right)
             + λ_3 \left( ∫_{-∞}^∞ (x - μ)^2 p(x) dx - σ^2 \right)
\end{align*}
<p>
変分<br  />
</p>
\begin{align*}
    \frac{δF}{δp(x)} = & - \frac{δ}{δp(x)} ∫_{-∞}^∞ p(x) \ln p(x) dx
                         + λ_1 \frac{δ}{δp(x)} ∫_{-∞}^∞ p(x) dx \\
                       & + λ_2 \frac{δ}{δp(x)} ∫_{-∞}^∞ x p(x) dx
                         + λ_3 \frac{δ}{δp(x)} ∫_{-∞}^∞ (x - μ)^2 p(x) dx
\end{align*}
\begin{align*}
    I[p(x)] = ∫ p(x) f(x) dx
\end{align*}
\begin{align*}
    I[p(x) + εη(x)] = & ∫ \{p(x) + εη(x)\} f(x) dx \\
                    = & ∫ p(x) f(x) dx + ε ∫ η(x) f(x) dx \\
                    = & I[p(x)] + ε ∫ η(x) f(x) dx \\
\end{align*}
<p>
付録D (D.3)式<br  />
</p>
\begin{align*}
    F[y(x) + εη(x)] = F[y(x)] + ε ∫ \frac{δF}{δy(x)} η(x) dx + O(ε^2)
\end{align*}
<p>
と比較すると<br  />
</p>
\begin{align*}
    \frac{δI}{δp(x)} = f(x)
\end{align*}

\begin{align*}
    J[p(x)] = ∫ p(x) \ln p(x) dx
\end{align*}
\begin{align*}
    J[p(x) + εη(x)]
    = & ∫ \{p(x) + εη(x)\} \ln \{p(x) + εη(x)\} dx \\
    = & ∫ \{p(x) + εη(x)\} \{\ln p(x) + \ln^{(1)}(p(x)) εη(x) + O(ε^2) \} dx \\
    = & ∫ \{p(x) + εη(x)\} \{\ln p(x) + \frac{1}{p(x)} εη(x) + O(ε^2) \} dx \\
    = & ∫ [p(x) \ln p(x) + ε \{η(x) \ln p(x) + p(x) \frac{1}{p(x)} η(x) \} + O(ε^2) ] dx \\
    = & ∫ [p(x) \ln p(x) + ε \{\ln p(x) + 1 \} η(x) + O(ε^2) ] dx \\
    = & ∫ p(x) \ln p(x) dx + ε ∫ \{ \ln p(x) + 1 \} η(x) dx + O(ε^2) \\
    = & J[p(x)] + ε ∫ \{ \ln p(x) + 1 \} η(x) dx + O(ε^2) \\
\end{align*}
<p>
付録D (D.3)式と比較すると<br  />
</p>
\begin{align*}
    \frac{δJ}{δp(x)} = \ln p(x) + 1
\end{align*}

<p>
これらを用いて<br  />
</p>
\begin{align*}
    \frac{δF}{δp(x)} = - \ln p(x) - 1 + λ_1 + λ_2 x + λ_3 (x - μ)^2
\end{align*}
<p>
停留点は<br  />
</p>
\begin{align*}
    0 = & - \ln p(x) - 1 + λ_1 + λ_2 x + λ_3 (x - μ)^2 = 0 \\
    p(x) = & \exp \{ - 1 + λ_1 + λ_2 x + λ_3 (x - μ)^2 \}    & \text{(1.108)} \\
\end{align*}
</div>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="todo TODO">TODO</span> 1.35 [www]</h3>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="done DONE">DONE</span> 1.36 凸⇔2階微分が正</h3>
<div class="outline-text-3" id="text-1-6">
\begin{align*}
    ∀a.∀b.∀λ∈[0,1]. f(λa + (1 - λ)b) ≦ λf(a) + (1 - λ)f(b) ⇔ ∀x. d^2f(x)/dx2 > 0 \\
\end{align*}

\begin{align*}
    \frac{df(x)}{dx}
        = & \lim_{ε_1→0} \frac{{f(x+ε_1) - f(x)}}{ε_1} \\
    \frac{d^2f(x)}{dx^2}
        = & \lim_{ε_2→0} \frac{f'(x+ε_2)}{ε_2} \\
        = & \lim_{ε_2→0} \lim_{ε_1→0} \frac{f(x+ε_2+ε_1) - f(x+ε_2) - f(x+ε_1) + f(x)}{ε_1ε_2} \\
\end{align*}
<p>
\(x = a\)、\(x+ε_2+ε_1 = b\)とすると<br  />
</p>
\begin{align*}
    &  x + ε_2 = λ a + (1 - λ )b  &  λ  = \frac{x + ε_2 - b}{a - b} = \frac{ε_1}{ε_2+ε_1} \\
    &  x + ε_1 = λ'a + (1 - λ')b  &  λ' = \frac{x + ε_1 - b}{a - b} = \frac{ε_2}{ε_2+ε_1} \\
\end{align*}
\begin{align*}
    f(x + ε_2) ≦ & \frac{ε_1}{ε_2 + ε_1}f(x) + \frac{ε_2}{ε_2 + ε_1}f(x + ε_2 + ε_1) \\
    f(x + ε_1) ≦ & \frac{ε_2}{ε_2 + ε_1}f(x) + \frac{ε_1}{ε_2 + ε_1}f(x + ε_2 + ε_1) \\
    f(x + ε_2) + f(x + ε_1) ≦ &   \frac{ε_1}{ε_2 + ε_1}f(x) + \frac{ε_2}{ε_2 + ε_1}f(x + ε_2 + ε_1) \\
                             & + \frac{ε_2}{ε_2 + ε_1}f(x) + \frac{ε_1}{ε_2 + ε_1}f(x + ε_2 + ε_1) \\
    f(x + ε_2) + f(x + ε_1) ≦ & f(x) + f(x + ε_2 + ε_1) \\
    \frac{d^2f(x)}{dx^2} ≧ & 0 \\
\end{align*}
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="done DONE">DONE</span> 1.37 H[x,y] = H[y|x] + H[x] (1.112) の証明</h3>
<div class="outline-text-3" id="text-1-7">
<p>
条件付きエントロピーの定義(1.111)より<br  />
    H[y|x] = -&int;&int; p(y,x) ln p(y|x) dydx<br  />
確率の乗法定理 p(x,y) = p(y|x)p(x) より<br  />
    H[y|x] = -&int;&int; p(y,x) ln p(x,y)/p(x) dydx<br  />
           = -&int;&int; p(x,y) ln p(x,y)/p(x) dydx<br  />
           = -&int;&int; p(x,y) {ln p(x,y) - ln p(x)} dydx<br  />
           = -&int;&int; p(x,y) ln p(x,y) dydx + &int;&int; p(x,y) ln p(x) dydx<br  />
ここで<br  />
    H[x,y] = -&int;&int; p(x,y) ln p(x,y) dydx<br  />
    H[x]   = -&int;&int; p(x,y) ln p(x) dydx<br  />
これらの定義を用いると、<br  />
    H[y|x] = - H[x,y] + H[x]<br  />
    H[x,y] = H[y|x] + H[x]<br  />
</p>
</div>
</div>
<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8"><span class="todo TODO">TODO</span> 1.38 [www] イェンセンの不等式</h3>
<div class="outline-text-3" id="text-1-8">
<p>
f(λa + (1 - λ)b) ≦ λf(a) + (1 - λ)f(b)    (1.114)<br  />
</p>

<p>
f(Σ<sub>i=1</sub><sup>M</sup> λ<sub>i</sub> x<sub>i</sub>) ≦ Σ<sub>i=1</sub><sup>M</sup> λ<sub>i</sub> f(x<sub>i</sub>)    (1.115)<br  />
</p>
</div>
</div>
<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9"><span class="todo TODO">TODO</span> 1.39</h3>
</div>
<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10"><span class="todo TODO">TODO</span> 1.40</h3>
</div>
<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11"><span class="done DONE">DONE</span> 1.41 [www] 相互情報量\(I[x,y] = H[x] - H[x|y]\)の証明</h3>
<div class="outline-text-3" id="text-1-11">
<p>
相互情報量の定義(1.120)より<br  />
</p>
\begin{align*}
    I[x,y] = & KL(p(x,y)||p(x)p(y))
           = & - \int\int p(x,y) \ln(p(x)p(y)/p(x,y)) dxdy
\end{align*}
<p>
乗法定理\(p(x,y)=p(x|y)p(y)\)より<br  />
</p>
\begin{align*}
    I[x,y] = & - \int\int p(x,y) \ln(p(x)/p(x|y)) dxdy
           = & - \int\int p(x,y) \ln(p(x))dxdy + \int\int p(x,y)ln(p(x|y)) dxdy
           = & H[x] - H[x|y]
\end{align*}
<p>
同時確率分布の対称性より\(I[x,y] = H[y] - H[y|x]\)も成り立つ。<br  />
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.50.1 (<a href="http://orgmode.org">Org</a> mode 8.2.3a)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
