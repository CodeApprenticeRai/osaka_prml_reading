#+INCLUDE: "./tex-macros.org"
#+TITLE: PRML 第2章 演習 2.11-2.20
* PRML 第2章 演習 2.11-2.20
** DONE 2.11 [www] ディリクレ分布の下での\(\ln μ_j\)の期待値
ディリクレ分布 p.75 (2.38)
\begin{align*}
    \Dir(\μ|\α) = & K(\α) \prod_{k=1}^M μ_k^{α_k-1}
\end{align*}
ここで
\begin{align*}
    K(\α) = & \f{Γ(α_0)}{Γ(α_1) \cdots Γ(α_M)} \\
\end{align*}
ディリクレ分布の正規化定数を除いた部分を\(α_j\)で偏微分して、以下の関係を得る。
(\((a^x)' = a^x \ln a \)を用いる。)
\begin{align*}
    \p{}{α_j} \prod_{k=1}^M μ_k^{α_k-1} = & \ln μ_j \prod_{k=1}^M μ_k^{α_k-1} \\
\end{align*}
ディリクレ分布の下での\(\ln μ_j\)の期待値は
\begin{align*}
    \E[\ln μ_j]
    = & K(\α) ∫_0^1 \cdots ∫_0^1 \ln μ_j \prod_{k=1}^K μ_k^{α_k-1} dμ_1 \cdots dμ_M \\
    = & K(\α) \p{}{α_j} ∫_0^1 \cdots ∫_0^1 \prod_{k=1}^K μ_k^{α_k-1} dμ_1 \cdots dμ_M \\
    = & K(\α) \p{}{α_j} \f{1}{K(\α)} \\
    = & - \p{}{α_j} \ln K(\α) \\
    = & - \p{}{α_j} \ln \f{Γ(α_0)}{Γ(α_1) \cdots Γ(α_M)} \\
    = & - \p{}{α_j} \ln Γ(α_0) + \p{}{α_j} \sum_{k=1}^M \ln Γ(α_k) \\
    = & - \p{}{α_0} \ln Γ(α_0) \p{α_0}{α_j} + \p{}{α_j} \ln Γ(α_j) \\
    = & - \p{}{α_0} \ln Γ(α_0) + \p{}{α_j} \ln Γ(α_j) \\
    = & ψ(α_j) - ψ(α_0) \\
\end{align*}

** TODO 2.12 一様分布が正規化されていることの証明と平均、分散
** TODO 2.13 2つのガウス分布の間のカルバック-ライブラーダイバージェンス
** TODO 2.14 [www] 共分散が所与のとき、エントロピーを最大にする多変量分布はガウス分布であることの証明
** TODO 2.15 多変量ガウス分布のエントロピー
** TODO 2.16 [www] 別々のガウス分布に従う2つの確率変数の和のエントロピー
** DONE 2.17 [www] 多変量ガウス分布の精度行列を対称行列に制限しても一般性を失わないことの証明
任意の正方行列\(\Λ\)を考え、その要素を\(Λ_{ij}\)とする。
\(\Λ^S\)、\(\Λ^A\)を以下のように定義すれば、常に\(\Λ = \Λ^S + \Λ^A\)と書くことができる。
\begin{align*}
    Λ_{ij}^S = \f{Λ_{ij} + Λ_{ji}}{2}, &
    Λ_{ij}^A = \f{Λ_{ij} - Λ_{ji}}{2}
\end{align*}
\(Λ_{ij}^S = Λ_{ji}^S\)だから、\(\Λ^S\)は対称行列である。
\(Λ_{ij}^A = - Λ_{ji}^A\)だから\(\Λ^A\)は反対称行列である。

多変量ガウス分布の指数部分の二次形式は、
\(\Λ = \Σ^{-1}\)は精度行列として、以下のように書ける。
\begin{align*}
      & \f{1}{2} \sum_{i=1}^D \sum_{j=1}^D (x_i - \mu_i) Λ_{ij} (x_j - \mu_j) \\
    = & \f{1}{2} \sum_{i=1}^D \sum_{j=1}^D (x_i - \mu_i) (Λ_{ij}^S + Λ_{ij}^A) (x_j - \mu_j) \\
    = & \f{1}{2} \sum_{i=1}^D \sum_{j=1}^D (x_i - \mu_i) Λ_{ij}^S (x_j - \mu_j)
      + \f{1}{2} \sum_{i=1}^D \sum_{j=1}^D (x_i - \mu_i) Λ_{ij}^A (x_j - \mu_j) \\
    = & \f{1}{2} \sum_{i=1}^D \sum_{j=1}^D (x_i - \mu_i) Λ_{ij}^S (x_j - \mu_j) \\
\end{align*}
よって、常に精度行列を対称行列ととってよい。

** TODO 2.18 実対称行列の固有値が実数となることの証明
** TODO 2.19 固有方程式を満たす実対称行列が固有値と固有ベクトルの積で表せることの証明
** TODO 2.20 [www] 行列が正定値であるための必要十分条件
